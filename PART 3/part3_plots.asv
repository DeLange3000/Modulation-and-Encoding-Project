%% QAM 16

BER_QAM16 = [0.140937800000000
0.118920500000000
0.0977003000000000
0.0774742000000000
0.0585825000000000
0.0420105000000000
0.0278816000000000
0.0169723000000000
0.00925680000000000
0.00435560000000000
0.00174410000000000
0.000574200000000000
0.000135000000000000
2.36000000000000e-05
2.50000000000000e-06
1.00000000000000e-07
0];

%% CFO

BER_CFO1 = [0.140936600000000
0.118944300000000
0.0977287000000000
0.0775092000000000
0.0585949000000000
0.0420368000000000
0.0279128000000000
0.0170037000000000
0.00927160000000000
0.00437050000000000
0.00174660000000000
0.000578400000000000
0.000136800000000000
2.44000000000000e-05
2.50000000000000e-06
0
0];

BER_CFO2 = [0.141078000000000
0.119109100000000
0.0978804000000000
0.0775217000000000
0.0587947000000000
0.0420696000000000
0.0279465000000000
0.0170717000000000
0.00930700000000000
0.00441870000000000
0.00182000000000000
0.000582400000000000
0.000144800000000000
2.63000000000000e-05
3.70000000000000e-06
2.00000000000000e-07
0];

BER_CFO5 = [0.141050700000000
0.119249000000000
0.0982665000000000
0.0779845000000000
0.0590670000000000
0.0424699000000000
0.0283758000000000
0.0173888000000000
0.00963470000000000
0.00472460000000000
0.00192920000000000
0.000659200000000000
0.000178100000000000
3.22000000000000e-05
5.30000000000000e-06
3.00000000000000e-07
0];

BER_CFO10 = [0.142117800000000
0.120361900000000
0.0993495000000000
0.0792605000000000
0.0606325000000000
0.0440762000000000
0.0300243000000000
0.0189642000000000
0.0108957000000000
0.00556830000000000
0.00256190000000000
0.000965700000000000
0.000297300000000000
7.79000000000000e-05
1.26000000000000e-05
1.90000000000000e-06
0];

BER_CFO25 = [0.148258200000000
0.127159100000000
0.107203800000000
0.0881823000000000
0.0707701000000000
0.0548103000000000
0.0411971000000000
0.0295307000000000
0.0203393000000000
0.0132358000000000
0.00814420000000000
0.00460440000000000
0.00239130000000000
0.00106000000000000
0.000415300000000000
0.000131700000000000
3.56000000000000e-05];

BER_CFO50 = [0.168056900000000
0.150097500000000
0.133450400000000
0.118533100000000
0.104588500000000
0.0923205000000000
0.0810932000000000
0.0710804000000000
0.0619328000000000
0.0538019000000000
0.0465575000000000
0.0398829000000000
0.0338899000000000
0.0284341000000000
0.0233105000000000
0.0186357000000000
0.0144894000000000];

BER_CFO100 = [0.235466800000000
0.224223300000000
0.214939900000000
0.207367700000000
0.201956200000000
0.197892700000000
0.194884400000000
0.193186100000000
0.192206000000000
0.191581200000000
0.191224600000000
0.191142700000000
0.190963000000000
0.190962800000000
0.190893500000000
0.190980300000000
0.190950400000000];





figure
hold on
plot(0:16, BER_QAM16)
plot(0:16, BER_CFO1)
plot(0:16, BER_CFO2)
plot(0:16, BER_CFO5)
plot(0:16, BER_CFO10)
plot(0:16, BER_CFO25)
plot(0:16, BER_CFO50)
plot(0:16, BER_CFO100)
set(gca, 'YScale', 'log')
ylabel("BER")
xlabel("Eb/N0 [dB]")
title('BER of 16QAM with carrier frequency offset')
legend('0 ppm', '1 ppm', '2 ppm', '5 ppm', '10 ppm', '25 ppm', '50 ppm', '100 ppm')

%% phase offset

BER_PHASE1 = [0.141121800000000
0.119196600000000
0.0980856000000000
0.0778208000000000
0.0589854000000000
0.0424014000000000
0.0282035000000000
0.0172569000000000
0.00947700000000000
0.00459480000000000
0.00186030000000000
0.000613900000000000
0.000162400000000000
3.01000000000000e-05
3.10000000000000e-06
5.00000000000000e-07
0];

BER_PHASE2 = [0.141705000000000
0.119896400000000
0.0984260000000000
0.0784229000000000
0.0596136000000000
0.0429775000000000
0.0289682000000000
0.0179519000000000
0.0101739000000000
0.00504600000000000
0.00217110000000000
0.000784300000000000
0.000227100000000000
4.59000000000000e-05
8.30000000000000e-06
1.50000000000000e-06
0];

BER_PHASE5 = [0.144599600000000
0.123370400000000
0.102706000000000
0.0831326000000000
0.0651587000000000
0.0488910000000000
0.0350169000000000
0.0236469000000000
0.0149975000000000
0.00881950000000000
0.00472720000000000
0.00227780000000000
0.000970300000000000
0.000341600000000000
9.48000000000000e-05
2.23000000000000e-05
3.10000000000000e-06];

BER_PHASE10 = [0.155348800000000
0.135638600000000
0.117135400000000
0.0999879000000000
0.0839537000000000
0.0692989000000000
0.0564432000000000
0.0452431000000000
0.0352470000000000
0.0269359000000000
0.0200018000000000
0.0143151000000000
0.00977230000000000
0.00625900000000000
0.00368170000000000
0.00193530000000000
0.000895400000000000];

BER_PHASE15 = [0.172171300000000
0.155124800000000
0.139390000000000
0.125655700000000
0.113104300000000
0.101561900000000
0.0917737000000000
0.0824818000000000
0.0743703000000000
0.0672082000000000
0.0605203000000000
0.0544956000000000
0.0489143000000000
0.0437515000000000
0.0388172000000000
0.0337306000000000
0.0289085000000000];

BER_PHASE20 = [0.194108700000000
0.179935200000000
0.167451800000000
0.157031400000000
0.148374900000000
0.140932700000000
0.134792700000000
0.130036400000000
0.125998100000000
0.123010800000000
0.120781500000000
0.119515700000000
0.119178500000000
0.119577500000000
0.120679800000000
0.122431800000000
0.124469100000000];


figure
hold on
plot(0:16, BER_QAM16)
plot(0:16, BER_PHASE1)
plot(0:16, BER_PHASE2)
plot(0:16, BER_PHASE5)
plot(0:16, BER_PHASE10)
plot(0:16, BER_PHASE15)
plot(0:16, BER_PHASE20)
set(gca, 'YScale', 'log')
ylabel("BER")
xlabel("Eb/N0 [dB]")
title('BER of 16QAM with phase shift')
legend('0°', '1°', '2°', '5°', '10°', '15°', '20°')
%% sample time offset

BER_STO0_01 = [0.142820000000000
0.118610000000000
0.0977600000000000
0.0767300000000000
0.0578300000000000
0.0423800000000000
0.0272000000000000
0.0168000000000000
0.00900000000000000
0.00417000000000000
0.00203000000000000
0.000550000000000000
0.000120000000000000
3.00000000000000e-05
0
0
0];

BER_STO0_02 = [0.141630000000000
0.118100000000000
0.0977100000000000
0.0764600000000000
0.0571500000000000
0.0418800000000000
0.0281000000000000
0.0174400000000000
0.00903000000000000
0.00437000000000000
0.00157000000000000
0.000590000000000000
7.00000000000000e-05
2.00000000000000e-05
0
0
0];

BER_STO0_05 = [0.141344000000000
0.119083000000000
0.0984850000000000
0.0772020000000000
0.0592240000000000
0.0423280000000000
0.0278450000000000
0.0170610000000000
0.00945100000000000
0.00455000000000000
0.00185000000000000
0.000601000000000000
0.000126000000000000
3.00000000000000e-05
2.00000000000000e-06
0
0];

BER_STO0_1 = [];

BER_STO0_3 = [];

BER_STO0_5 = [];


figure
hold on
plot(0:16, BER_QAM16)
plot(0:16, BER_STO0_01)
plot(0:16, BER_STO0_02)
plot(0:16, BER_STO0_05)
plot(0:16, BER_STO0_07)
plot(0:16, BER_STO0_1)
plot(0:16, BER_STO0_3)
plot(0:16, BER_STO0_5)
set(gca, 'YScale', 'log')
ylabel("BER")
xlabel("Eb/N0 [dB]")
title('BER of 16QAM with sampling time offset')
legend('0T', '0.01T', '0.02T', '0.05T', '0.07T', '0.1T', '0.3T', '0.5T')



