close all
clc
clear


BER_pam1 = [0.0789150000000000 0.055838000000000 0.0377490000000000 0.0226910000000000 0.0124200000000000 0.00586100000000000 0.00241900000000000 0.000763000000000000 0.000219000000000000 3.40000000000000e-05 4.00000000000000e-06];
BER_qam2 = [0.0789425000000000
0.0559850000000000
0.0377985000000000
0.0228615000000000
0.0126375000000000
0.00605500000000000
0.00233850000000000
0.000774000000000000
0.000178000000000000
3.55000000000000e-05
1.50000000000000e-06
5.00000000000000e-07];
BER_qam4 = [0.140860500000000
0.118954000000000
0.0977317500000000
0.0773932500000000
0.0585857500000000
0.0419385000000000
0.0279185000000000
0.0170302500000000
0.00930425000000000
0.00441025000000000
0.00177725000000000
0.000563000000000000
0.000143250000000000
2.45000000000000e-05
4.25000000000000e-06];
BER_qam6 = [0.199876000000000
0.177850500000000
0.157242333333333
0.137272333333333
0.118624500000000
0.100855666666667
0.0840655000000000
0.0677870000000000
0.0523825000000000
0.0386655000000000
0.0269078333333333
0.0171495000000000
0.0100190000000000
0.00514400000000000
0.00231250000000000
0.000870000000000000
0.000261333333333333
6.38333333333333e-05
9.50000000000000e-06
1.16666666666667e-06
1.66666666666667e-07];



BER_HD_5_iterations = [0.283936718750000
0.213657031250000
0.131418750000000
0.0542710937500000
0.0114773437500000
0.000939062500000000
1.79687500000000e-05
0
0
0
0];

BER_SD_15_iterations = [];

BER_HD_1_iteration = [0.283291406250000
0.214907812500000
0.133790625000000
0.0566492187500000
0.0125687500000000
0.00123593750000000
5.70312500000000e-05
7.81250000000000e-07
0
0
0];

BER_SD_1_iteration =[0.193117187500000
0.128341406250000
0.0655296875000000
0.0208906250000000
0.00282265625000000
0.000114062500000000
7.81250000000000e-07
0
0
0
0];

BER_HD_2_iterations = [0.280650000000000
0.212506250000000
0.129941406250000
0.0537781250000000
0.0118265625000000
0.00100156250000000
2.57812500000000e-05
1.56250000000000e-06
0
0
0];

BER_SD_3_iterations = [0.202389843750000
0.130969531250000
0.0568109375000000
0.0101671875000000
0.000435937500000000
3.90625000000000e-06
0
0
0
0
0]

BER_HD_7_iterations = [0.279046875000000
0.208839843750000
0.125226562500000
0.0514671875000000
0.0104070312500000
0.000830468750000000
1.48437500000000e-05
0
0
0
0];
BER_SD_7_iterations = [0.300366406250000
0.260850781250000
0.200203906250000
0.0747929687500000
0.00495390625000000
6.56250000000000e-05
7.81250000000000e-07
0
0
0
0];

BER_HD_9_iterations = [0.281491406250000
0.211202343750000
0.127065625000000
0.0516960937500000
0.0109828125000000
0.000803906250000000
1.17187500000000e-05
0
0
0
0];

BER_SD_11_iterations = [0.383654687500000
0.369060156250000
0.347992968750000
0.176010156250000
0.0110265625000000
0.000158593750000000
2.34375000000000e-06
0
0
0
0];

BER_SD_18_iterations = [0.457275781250000
0.454669531250000
0.452172656250000
0.273790625000000
0.0209531250000000
0.000500000000000000
1.25000000000000e-05
0
0
0
0];

BER_SD_21_iterations = [0.458060156250000
0.456740625000000
0.454264843750000
0.305492968750000
0.0306234375000000
0.000937500000000000
4.68750000000000e-06
0
0
0
0];

BER_pam1_new = [0.213264500000000
0.158431900000000
0.103771000000000
0.0563562000000000
0.0228921000000000
0.00598820000000000
0.000784100000000000
3.40000000000000e-05
5.00000000000000e-07
0
0];

figure
hold on
plot(-5:2:15, BER_pam1_new(1:11))
% plot(0:10, BER_qam2(1:11))
% plot(0:10, BER_qam4(1:11))
% plot(0:10, BER_qam6(1:11))
%plot(0:5, BER_SD_15_iterations(1:6))
plot(-5:2:15, BER_HD_1_iteration(1:11))
plot(-5:2:15, BER_HD_2_iterations(1:11))
plot(-5:2:15, BER_HD_5_iterations(1:11))
plot(-5:2:15, BER_HD_7_iterations(1:11))
plot(-5:2:15, BER_HD_9_iterations(1:11))
set(gca, 'YScale', 'log')
xlabel('Eb/N0')
ylabel("BER")
%legend('BPSK', 'QPSK', '16QAM', '64QAM')
legend('BPSK', '1 iteration', '2 iterations', '5 iterations', '7 iterations', '9 iterations')
title('Hard Decoding of pam')

figure
hold on
plot(-5:2:15, BER_pam1_new(1:11))
% plot(0:10, BER_qam2(1:11))
% plot(0:10, BER_qam4(1:11))
% plot(0:10, BER_qam6(1:11))
%plot(0:5, BER_SD_15_iterations(1:6))
plot(-5:2:15, BER_SD_1_iteration(1:11))
plot(-5:2:15, BER_SD_3_iterations(1:11))
plot(-5:2:15, BER_SD_7_iterations(1:11))
plot(-5:2:15, BER_SD_11_iterations(1:11))
%plot(0:10, BER_SD_15_iterations(1:11))
plot(-5:2:15, BER_SD_18_iterations(1:11))
plot(-5:2:15, BER_SD_21_iterations(1:11))
set(gca, 'YScale', 'log')
xlabel('Eb/N0')
ylabel("BER")
%legend('BPSK', 'QPSK', '16QAM', '64QAM')
legend('BPSK', '1 iteration', '3 iterations', '7 iterations', '11 iterations', '15 iterations', '18 iterations', '21 iterations')
title('Soft Decoding of pam')